---
title: "The LGBTQ+ Minority, a Bellwether for Democracy?"
format:
  pdf:
    toc: true
    number-sections: true
editor: visual
---

```{r setup, include=FALSE}
# turn off error message output
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
```

```{r load packages}
#| include: false

if (!"pacman" %in% installed.packages()[,1]){
  install.packages("pacman")
}

# load pacman
library("pacman")

# load all other packages
pacman::p_load("tidyverse", "here", "readxl", "ggplot2", "ggrepel", "devtools")

if (!"vdemdata" %in% installed.packages()[,1]){
  devtools::install_github("vdeminstitute/vdemdata")
}

#load the democracy dataset
library(vdemdata)



```

```{r load datasets}
#| include: false

# load the LGBTQ+ freedom index
LGBTQ_index <- 
  readxl::read_xls(here("Datasets", 'GAI-Data-Download-2000-2020.xls'),
                   col_names = FALSE) %>%
  rename(country = "...1",
         LGBTQ_Score = "...2",
         coordinates = "...4") %>%
  select(-...3)

# read the freedom house score dataset
Freedom_house <- 
  readxl::read_xlsx(here("Datasets", 'All_data_FIW_2013-2023.xlsx'), sheet = 2)

# also load the explanation of what the scores mean
Freedom_house_guide <- 
  readxl::read_xlsx(here("Datasets", 'All_data_FIW_2013-2023.xlsx'), sheet = 1)

VDEM <- vdemdata::vdem %>% 
  filter(year >= 2000) %>%
  rename(country = "country_name") %>%
  select(country, year, v2x_polyarchy, v2x_libdem, v2x_partipdem, v2x_delibdem, 
         v2x_egaldem) %>%
  group_by(country) %>%
  mutate(v2x_polyarchy = mean(v2x_polyarchy),
         v2x_libdem = mean(v2x_libdem),
         v2x_partipdem = mean(v2x_partipdem), 
         v2x_delibdem = mean(v2x_delibdem),
         v2x_egaldem = mean(v2x_egaldem)) %>%
  distinct(country, .keep_all = TRUE) %>%
  select(-year) %>%
  # rename any countries
  mutate(country = 
           case_when(country == "United States of America" ~ "United States",
            .default = country))
```

```{r Filter and merge datasets}
#| include: false

Freedom_house_parsed <- Freedom_house %>%
  # average the Civil liberties and political rights rating across all years
  rename(country = "Country/Territory",
         PR_rating = "PR rating",
         CL_rating = "CL rating") %>%
  group_by(country) %>%
  mutate(PR_rating = mean(PR_rating),
         CL_rating = mean(CL_rating)) %>%
  distinct(country, .keep_all = TRUE) %>%
  select(country, PR_rating, CL_rating) %>%
  ungroup()
  
Merged_dataset <- left_join(LGBTQ_index, Freedom_house_parsed, by = "country")

Merged_dataset <- left_join(Merged_dataset, VDEM, by = "country")

```

```{r define countries to label on plots}
#| include: false

label = c("Nepal", "Iceland", "Brazil", "Taiwan", "Israel", "France", "Thailand", "Vietnam", "Egypt", "Iraq", "Sudan", "Mongolia", "Ghana", "Bahamas", "Ukraine", "Russia", "Senegal", "Moldova", "Japan", "Iran", "United States", "Azerbaijan")

Merged_dataset <- Merged_dataset %>%
  mutate(label = case_when(country %in% label ~ country))

```

```{r civil liberties plot}
#| echo: false

# civil liberties plot
ggplot(data = Merged_dataset, mapping = aes(x = LGBTQ_Score, y = CL_rating)) + geom_point() +
  # reverse the y axis as 1 is the most protected
  scale_y_reverse() +
  xlab("LGBTQ+ Index (10 is Most Accepted)") +
  ylab("Civil Liberty Index (1 is Most Protected)") +
  # add a nonlinear trend line
  geom_smooth() +
  geom_text_repel(aes(label=label)) 

#ggsave(here("Output", "Civil_Liberties.png"), dpi = 1200)
```

```{r political rights plot}
#| echo: false

# political rights plot
ggplot(data = Merged_dataset, mapping = aes(x = LGBTQ_Score, y = PR_rating)) + geom_point() +
  # inverse the y axis as 1 is represents the highest levels of protection
  scale_y_reverse() +
  xlab("LGBTQ+ Index (10 is Most Accepted)") +
  ylab("Political Rights Index (1 is Most Protected)") + 
  # add a nonlinear trend line
  geom_smooth() +
  geom_text_repel(aes(label=label)) 

#ggsave(here("Output", "Political_Rights.png"), dpi = 1200)
```

```{r Electoral Democracy Index Plot}
#| echo: false

ggplot(data = Merged_dataset, mapping = aes(x = LGBTQ_Score, y = v2x_polyarchy)) + geom_point() +
  xlab("LGBTQ+ Index (10 is Most Accepted)") +
  ylab("V-Dem Electoral Democracy Index") + 
  # add a nonlinear trend line
  geom_smooth() +
  geom_text_repel(aes(label=label)) 
```

```{r Liberal Democracy Index Plot}
#| echo: false

ggplot(data = Merged_dataset, mapping = aes(x = LGBTQ_Score, y = v2x_libdem)) + geom_point() +
  xlab("LGBTQ+ Index (10 is Most Accepted)") +
  ylab("V-Dem Liberal Democracy Index") + 
  # add a nonlinear trend line
  geom_smooth() +
  geom_text_repel(aes(label=label)) 
```

```{r Participatory Democracy Index Plot}
#| echo: false

ggplot(data = Merged_dataset, mapping = aes(x = LGBTQ_Score, y = v2x_partipdem)) + geom_point() +
  xlab("LGBTQ+ Index (10 is Most Accepted)") +
  ylab("V-Dem Participatory Democracy Index") + 
  # add a nonlinear trend line
  geom_smooth() +
  geom_text_repel(aes(label=label)) 

```

```{r  Deliberative democracy Index Plot}
#| echo: false

ggplot(data = Merged_dataset, mapping = aes(x = LGBTQ_Score, y = v2x_delibdem)) + geom_point() +
  xlab("LGBTQ+ Index (10 is Most Accepted)") +
  ylab("V-Dem Deliberative Democracy Index") + 
  # add a nonlinear trend line
  geom_smooth() +
  geom_text_repel(aes(label=label)) 

```

```{r Egalitarian democracy Index Plot}
#| echo: false

ggplot(data = Merged_dataset, mapping = aes(x = LGBTQ_Score, y = v2x_egaldem)) + geom_point() +
  xlab("LGBTQ+ Index (10 is Most Accepted)") +
  ylab("V-Dem Egalitarian Democracy Index") + 
  # add a nonlinear trend line
  geom_smooth() +
  geom_text_repel(aes(label=label)) 

```

# Ideas

-   The LGBTQ+ community provides the distinct advantage of existing to some degree in every country across the world, allowing for a comparable minority group across international borders.

-   Minority groups often act as a bellwether for a Democracy because suppression of a one group represents a systematic weakness of a country's institutions and inability of democratic protections at large.

-   Even if we ignore the humanity aspect, discrimination has an economic cost.

-   Is social conservative inherently anti-democratic?

# Abstract

Democracy is a combination of the Greek words for people (demos) and power (kratos), so in it's simplest terms it means rule by the people. But this definition has evolved with time, specifically with the balance of majority rule versus the liberties of the minority.

Spanning every country in the world, the lesbian, gay, bisexual, and transgender (LGBTQ+) minority provides a unique indicator of a country's democratic strength or lack thereof. As Democracy has evolved from simply majority rule to also upholding minority rights, it makes sense to look at the treatment of an often prosecuted group when determining whether or not a country is truly democratic. A failure to protect the basic civil liberties (i.e. freedom of expression, association, and beliefs) of one group can point to a wider systemic failing in institutions at large.
